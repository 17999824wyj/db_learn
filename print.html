<!DOCTYPE HTML>
<html lang="zh" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>KingBase单机部署指南(非官方版)</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">KingBase单机部署指南(非官方版)</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="前言"><a class="header" href="#前言">前言</a></h1>
<h2 id="简介"><a class="header" href="#简介">简介</a></h2>
<p>本书用于记录作者学习使用数据库之间发生的故事。</p>
<p>本书基于 mdbook 编写，已部署至 https://17999824wyj.github.io/db_learn/。</p>
<h2 id="声明"><a class="header" href="#声明">声明</a></h2>
<p>此处叠甲：</p>
<ul>
<li>非官方手册，均为自学期间的记录</li>
<li>作者郑重声明，其坚定地站在维护知识产权的立场上，全力支持正版软件的使用权</li>
<li>本手册仅用于学习交流，不得用于商业用途</li>
<li>若需要复现本手册的操作，则本手册中涉及的所有软件均需要读者自行下载，并保证软件来源合法合规</li>
</ul>
<h2 id="纠错与交流"><a class="header" href="#纠错与交流">纠错与交流</a></h2>
<p>联系方式：</p>
<ul>
<li>邮箱：<a href="mailto:abcd1234dbren@yeah.net">abcd1234dbren@yeah.net</a></li>
<li>github: <a href="">https://github.com/17999824wyj</a></li>
<li>gitee: <a href="">https://gitee.com/wang-yijia_DB</a></li>
<li>gitcode: <a href="">https://gitcode.com/abcd1234-wyj</a></li>
</ul>
<p>欢迎给本项目以及其它项目点 star</p>
<h2 id="近期更新内容"><a class="header" href="#近期更新内容">近期更新内容</a></h2>
<ul>
<li>2025-03-15: 更新了 QA 章节，增加了问题：<a href="./qa.html#%E5%A6%82%E4%BD%95%E5%9C%A8-navicat-%E9%87%8C%E7%9C%8B-er-%E5%9B%BE">"如何在 Navicat 里看 ER 图？"</a></li>
<li>2025-03-20: 增加了一个新的章节: <a href="./navicat-free.html">"脱离 Navicat 依赖"</a>，主要处理 macos 的操作适配</li>
<li>2025-03-20: 更新了 QA 章节，增加了问题：<a href="./qa.html#%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8-vscode-%E8%B0%83%E6%95%B4%E6%96%87%E4%BB%B6%E7%BC%96%E7%A0%81">"如何使用 vscode 调整文件编码？"</a></li>
</ul>
<h2 id="目录"><a class="header" href="#目录">目录</a></h2>
<ul>
<li><a href="./foreword.html">前言</a></li>
<li><a href="./connector.html">环境准备 - 数据库连接工具</a></li>
<li><a href="./kb-deploy.html">金仓数据库环境配置</a></li>
<li><a href="./connect-db.html">连接数据库</a></li>
<li><a href="./data-load.html">数据加载</a></li>
<li><a href="./data-migration.html">数据迁移</a></li>
<li><a href="./navicat-free.html">脱离 Navicat 依赖</a></li>
<li><a href="./qa.html">Q &amp; A</a></li>
<li><a href="./appendix-a.html">附录 A：对 .dmp 文件的探索</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="环境准备---数据库连接工具"><a class="header" href="#环境准备---数据库连接工具">环境准备 - 数据库连接工具</a></h1>
<p>在现代化的软件开发和维护过程中，数据库扮演着至关重要的角色。为了更高效、更安全地管理和操作数据库，我们通常不会直接在数据库服务器上执行命令，而是通过专业的数据库连接工具来进行。这些工具提供了友好的用户界面、便捷的操作方式以及强大的功能支持。</p>
<h2 id="本节目录"><a class="header" href="#本节目录">本节目录</a></h2>
<ul>
<li><a href="connector.html#%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87---%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E5%B7%A5%E5%85%B7">环境准备 - 数据库连接工具</a>
<ul>
<li><a href="connector.html#%E6%9C%AC%E8%8A%82%E7%9B%AE%E5%BD%95">本节目录</a></li>
<li><a href="connector.html#%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87---%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E5%B7%A5%E5%85%B7-navicat">环境准备 - 数据库连接工具 Navicat</a>
<ul>
<li><a href="connector.html#%E6%9C%89%E8%AF%BE%E7%A8%8B%E8%B5%84%E6%96%99%E5%8C%85">有课程资料包</a></li>
<li><a href="connector.html#%E6%97%A0%E8%AF%BE%E7%A8%8B%E8%B5%84%E6%96%99%E5%8C%85">无课程资料包</a></li>
<li><a href="connector.html#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9">注意事项</a></li>
<li><a href="connector.html#%E5%AE%8C%E6%88%90%E6%A0%87%E5%BF%97">完成标志</a></li>
</ul>
</li>
<li><a href="connector.html#%E5%BC%BA%E8%B0%83%E9%A1%B9">强调项</a></li>
</ul>
</li>
</ul>
<h2 id="环境准备---数据库连接工具-navicat"><a class="header" href="#环境准备---数据库连接工具-navicat">环境准备 - 数据库连接工具 Navicat</a></h2>
<p>Navicat 是一款广受欢迎的数据库管理工具，它支持多种数据库系统，如 MySQL、MariaDB、MongoDB、SQL Server、Oracle、PostgreSQL 以及 SQLite 等。Navicat 提供了强大的数据库管理功能，包括数据库开发、数据同步、结构管理、数据导入/导出等。需要注意的是，Navicat 是一款收费的正版软件，我们强烈建议用户购买正版以获得最佳的使用体验和售后服务。</p>
<h3 id="有课程资料包"><a class="header" href="#有课程资料包">有课程资料包</a></h3>
<p>如果您已经获得了课程资料包，那么您可以直接使用包内提供的 Navicat 安装程序。请按照以下步骤进行操作：</p>
<ol>
<li>解压课程资料包，找到 Navicat 安装程序。</li>
<li>阅读其内的 <code>准备Navicat/操作流程.txt</code> 文档。</li>
<li>双击安装程序，开始安装过程。</li>
<li>在安装过程中，请确保遵循屏幕上的提示进行操作，并同意软件许可协议。</li>
</ol>
<h3 id="无课程资料包"><a class="header" href="#无课程资料包">无课程资料包</a></h3>
<p>如果没有得到资料包，请自行下载 Navicat，下载地址为：https://www.navicat.com.cn/download/navicat-premium。</p>
<p>下载步骤如下：</p>
<ol>
<li>访问 Navicat 官方下载页面：https://www.navicat.com.cn/download/navicat-premium</li>
<li>选择适合您操作系统的版本进行下载。</li>
<li>下载完成后，运行安装程序。</li>
<li>安装过程中，您将需要同意软件许可协议。请仔细阅读协议内容，了解您的权利和义务。</li>
<li>按照安装向导的提示完成安装步骤。安装完成后，您将需要购买并输入正版授权信息来激活软件。</li>
</ol>
<h3 id="注意事项"><a class="header" href="#注意事项">注意事项</a></h3>
<p>在安装 Navicat 的过程中，以下是一些额外的建议和注意事项：</p>
<ul>
<li>确保您的计算机满足 Navicat 的系统要求。</li>
<li>在安装过程中，您可以选择自定义安装路径和功能组件。</li>
<li>安装完成后，您可以创建桌面快捷方式，以便快速访问 Navicat。</li>
<li>如果您在安装过程中遇到任何问题，可以参考 Navicat 官方提供的安装指南或者联系技术支持。</li>
</ul>
<h3 id="完成标志"><a class="header" href="#完成标志">完成标志</a></h3>
<p>通过以上步骤，应该能够成功安装并开始使用 Navicat，从而更加高效地管理和操作您的数据库。我们可以打开 Navicat 来验证此环境已经准备完毕，在打开 Navicat 后，应该能够看到如下主界面，作为完成环境准备的一个标志：</p>
<p><img src="./imgs/connectors/navicat.png" alt="Navicat 主界面" /></p>
<p><strong>注：新打开的 Navicat 窗口的左边栏部分，可能显示为空，这是因为尚未连接过任何数据库。</strong></p>
<h2 id="强调项"><a class="header" href="#强调项">强调项</a></h2>
<p><strong>再次强调，为了支持软件开发者的劳动成果，请使用正版软件。</strong></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="金仓数据库环境配置"><a class="header" href="#金仓数据库环境配置">金仓数据库环境配置</a></h1>
<p>本节旨在详细阐述金仓数据库的环境配置流程，涵盖了从安装金仓数据库、操作数据库，到使用数据库连接工具 Navicat 连接数据库的全方位说明。</p>
<h2 id="本节目录-1"><a class="header" href="#本节目录-1">本节目录</a></h2>
<ul>
<li><a href="kb-deploy.html#%E9%87%91%E4%BB%93%E6%95%B0%E6%8D%AE%E5%BA%93%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE">金仓数据库环境配置</a>
<ul>
<li><a href="kb-deploy.html#%E6%9C%AC%E8%8A%82%E7%9B%AE%E5%BD%95">本节目录</a></li>
<li><a href="kb-deploy.html#%E5%AE%89%E8%A3%85%E9%87%91%E4%BB%93%E6%95%B0%E6%8D%AE%E5%BA%93">安装金仓数据库</a>
<ul>
<li><a href="kb-deploy.html#%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85%E5%8C%85">下载安装包</a>
<ul>
<li><a href="kb-deploy.html#%E6%9C%89%E8%AF%BE%E7%A8%8B%E8%B5%84%E6%96%99%E5%8C%85">有课程资料包</a></li>
<li><a href="kb-deploy.html#%E6%97%A0%E8%AF%BE%E7%A8%8B%E8%B5%84%E6%96%99%E5%8C%85">无课程资料包</a></li>
</ul>
</li>
<li><a href="kb-deploy.html#%E4%BD%BF%E7%94%A8%E5%AE%89%E8%A3%85%E5%8C%85">使用安装包</a>
<ul>
<li><a href="kb-deploy.html#%E5%9B%BE%E5%BD%A2%E5%8C%96%E5%AE%89%E8%A3%85">图形化安装</a></li>
<li><a href="kb-deploy.html#%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%AE%89%E8%A3%85">命令行安装</a></li>
</ul>
</li>
<li><a href="kb-deploy.html#%E5%AE%8C%E6%88%90%E6%A0%87%E5%BF%97">完成标志</a></li>
</ul>
</li>
<li><a href="kb-deploy.html#%E5%BC%BA%E8%B0%83%E9%A1%B9">强调项</a></li>
</ul>
</li>
</ul>
<h2 id="安装金仓数据库"><a class="header" href="#安装金仓数据库">安装金仓数据库</a></h2>
<p>以下内容将介绍如何在 Windows 系统上进行金仓数据库的图形化安装。若您倾向于使用命令行安装，请参阅官方文档以获取详细步骤。</p>
<p><strong>PS：我使用的金仓数据库版本为 V8R6。</strong></p>
<h3 id="下载安装包"><a class="header" href="#下载安装包">下载安装包</a></h3>
<h4 id="有课程资料包-1"><a class="header" href="#有课程资料包-1">有课程资料包</a></h4>
<p>在的课程资料包中，<code>安装数据库</code> 文件夹内包含了一个以 <code>.iso</code> 为扩展名的文件。双击此文件以打开，其内部有一个名为 <code>KINGBASE.EXE</code> 的安装程序。</p>
<h4 id="无课程资料包-1"><a class="header" href="#无课程资料包-1">无课程资料包</a></h4>
<p>若未获得课程资料包，可访问金仓数据库官方网站以下载安装包：<a href="https://download.kingbase.com.cn/xzzx/index.htm">金仓数据库官方下载</a></p>
<h3 id="使用安装包"><a class="header" href="#使用安装包">使用安装包</a></h3>
<h4 id="图形化安装"><a class="header" href="#图形化安装">图形化安装</a></h4>
<p>以下是基于图形界面的安装步骤。若在安装过程中遇到任何错误，请参考金仓官方手册：<a href="https://bbs.kingbase.com.cn/kingbase-doc/v9/install-updata/install-windows/install-windows-8.html#id4">金仓数据库 Windows 安装指南</a></p>
<p>我们将逐步解析安装过程：</p>
<p>在安装之前，请先保证系统某一磁盘(单一磁盘！)的剩余空间大于 12GB，否则安装程序会拒绝安装。</p>
<ol>
<li>运行 <code>KINGBASE.EXE</code>，等待其解压完成后自动开始安装。</li>
<li>遵循安装向导的指示完成安装。部分情况下，可能会让选择 <code>实例管理</code>，推荐选择 <code>新的实例</code>。
<ol>
<li>在打开的窗口中，先同意许可证，然后点击 <code>下一步</code>：
<img src="./imgs/kb/accept_license.png" alt="" /></li>
<li>然后选择许可协议。点击右侧的 <code>选择授权文件</code> 后：
<img src="./imgs/kb/choose_license.png" alt="" />
<ul>
<li>对于有课程资料包的用户，请选择课程资料包里面的 <code>安装数据库</code> 目录下的名叫 <code>license_***</code> 的目录，里面有一个名字类似 <code>license_***.dat</code> 的文件，选择该文件后，点击 <code>下一步</code>。</li>
<li>对于无课程资料包的用户，请在官网上下载到 <code>license.dat</code> 文件，然后选择该文件，点击 <code>下一步</code>。</li>
</ul>
</li>
<li>在<code>选择安装集</code>时，选择<code>完全安装</code>，之后点击<code>下一步</code>：
<img src="./imgs/kb/choose_install_set.png" alt="" /></li>
<li>在<code>选择安装目录</code>时，选择一个合适的目录进行安装，需要保证该目录隶属的磁盘有超过 12G 的剩余空间，否则会直接安装失败！</li>
<li>之后一直选择<code>下一步</code>，直到 <code>获取用户输入</code> 部分。此部分我们需要进行一系列配置(其它参数不用动)：
<img src="./imgs/kb/init_param.png" alt="" />
<ul>
<li>端口号配置：54321</li>
<li>管理员用户名：system</li>
<li>密码我们选择简单的 <code>123456</code></li>
<li>确认密码：<code>123456</code></li>
<li>编码：<code>GBK</code></li>
<li>兼容模式：<code>MySQL</code></li>
<li>大小写敏感：<code>NO</code></li>
</ul>
</li>
<li>最后，点击 <code>下一步</code>并稍作等待，程序即可完成安装。</li>
<li>如果过程中，出现提示说 <code>发生问题</code>，则请使用<strong>安装后自带的卸载工具</strong>将数据库卸载干净，然后重新安装。</li>
</ol>
</li>
</ol>
<h4 id="命令行安装"><a class="header" href="#命令行安装">命令行安装</a></h4>
<p>对于命令行安装，请参照以下官方手册进行：</p>
<ul>
<li>Windows 版：<a href="https://bbs.kingbase.com.cn/kingbase-doc/v9/install-updata/install-windows/index.html">金仓数据库 Windows 命令行安装指南</a></li>
<li>Linux 版：<a href="https://bbs.kingbase.com.cn/kingbase-doc/v9/install-updata/install-linux/index.html">金仓数据库 Linux 命令行安装指南</a></li>
</ul>
<h3 id="完成标志-1"><a class="header" href="#完成标志-1">完成标志</a></h3>
<p>如官方手册所示：</p>
<p><img src="./imgs/kb/fini_install.png" alt="" /></p>
<h2 id="强调项-1"><a class="header" href="#强调项-1">强调项</a></h2>
<p>由于作者在安装过程中并没有出现错误，故如果过程出现报错，请参考官方手册的 <a href="https://bbs.kingbase.com.cn/kingbase-doc/v9/install-updata/install-windows/install-windows-8.html#id4">QA 部分</a>。</p>
<p><strong>PS：有时候简单的重来也<code>可能</code>能够解决问题，但注意，重来之前务必把之前的内容删干净，且重来时选择 <code>新的实例</code>！</strong></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="连接数据库"><a class="header" href="#连接数据库">连接数据库</a></h1>
<h2 id="本节目录-2"><a class="header" href="#本节目录-2">本节目录</a></h2>
<ul>
<li><a href="connect-db.html#%E8%BF%9E%E6%8E%A5%E6%95%B0%E6%8D%AE%E5%BA%93">连接数据库</a>
<ul>
<li><a href="connect-db.html#%E6%9C%AC%E8%8A%82%E7%9B%AE%E5%BD%95">本节目录</a></li>
<li><a href="connect-db.html#%E4%BD%BF%E7%94%A8-navicat-%E8%BF%9E%E6%8E%A5%E9%87%91%E4%BB%93%E6%95%B0%E6%8D%AE%E5%BA%93">使用 Navicat 连接金仓数据库</a>
<ul>
<li><a href="connect-db.html#%E8%83%8C%E6%99%AF%E7%9F%A5%E8%AF%86">背景知识</a></li>
<li><a href="connect-db.html#%E8%BF%9E%E6%8E%A5%E6%AD%A5%E9%AA%A4">连接步骤</a></li>
</ul>
</li>
<li><a href="connect-db.html#%E5%AE%8C%E6%88%90%E6%A0%87%E5%BF%97">完成标志</a></li>
<li><a href="connect-db.html#%E5%B8%B8%E8%A7%81-q--a">常见 Q &amp; A</a>
<ul>
<li><a href="connect-db.html#%E5%9B%A0%E4%B8%BA%E6%95%B0%E6%8D%AE%E5%BA%93%E6%9C%AA%E6%89%93%E5%BC%80%E8%BF%9E%E6%8E%A5%E5%A4%B1%E8%B4%A5">因为数据库未打开，连接失败</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="使用-navicat-连接金仓数据库"><a class="header" href="#使用-navicat-连接金仓数据库">使用 Navicat 连接金仓数据库</a></h2>
<p>接下来，我们将介绍如何使用 Navicat 这一强大的数据库连接工具来连接金仓数据库。请确保您已经安装了 Navicat 并激活了正版授权，以便顺利执行以下步骤。</p>
<h3 id="背景知识"><a class="header" href="#背景知识">背景知识</a></h3>
<p>如文章：<a href="">https://www.zhihu.com/question/582960448</a> 所介绍的，金仓可以视作一个闭源的 <code>PostgreSQL</code>，因此我们使用 Navicat 连接金仓数据库时，需要使用 <code>PostgreSQL</code> 的连接方式。</p>
<h3 id="连接步骤"><a class="header" href="#连接步骤">连接步骤</a></h3>
<ol>
<li>打开 Navicat，点击左上角的 <code>连接</code> 按钮，选择 <code>PostgreSQL</code>，之后点击右下角的 <code>下一步</code>。
<img src="./imgs/connect-db/choose_way.png" alt="" /></li>
<li>在弹出的窗口中，填写连接信息，包括：
<img src="./imgs/connect-db/message.png" alt="" />
<ul>
<li><code>连接名称</code>：自定义，用于标识该连接。</li>
<li><code>主机</code>：由于是本机部署，因此填写 <code>localhost</code>。</li>
<li><code>端口</code>：金仓数据库默认端口为 <code>54321</code>。我们之前的<a href="./kb-deploy.html#%E5%9B%BE%E5%BD%A2%E5%8C%96%E5%AE%89%E8%A3%85">环境搭建章节</a>也是填写的这个端口。</li>
<li><code>初始数据库</code>：填写 <code>test</code>，这是金仓数据库的默认数据库，之前也配置过。</li>
<li><code>用户名</code>：填写 <code>system</code>，这是金仓数据库的默认用户名，之前也配置过。</li>
<li><code>密码</code>：之前配置的 <code>123456</code>。</li>
</ul>
</li>
<li>然后我们需要先点击左下角的 <code>测试连接</code> 按钮，确保连接信息正确。
<img src="./imgs/connect-db/test_ok.png" alt="" /></li>
<li>测试连接成功后，点击右下角的 <code>确定</code> 按钮，完成连接的创建。</li>
<li>若连接不成功，可以尝试按照<a href="connect-db.html#%E5%B8%B8%E8%A7%81-q--a">常见 Q &amp; A</a> 中的方法解决。</li>
</ol>
<h2 id="完成标志-2"><a class="header" href="#完成标志-2">完成标志</a></h2>
<p>双击 / 右键点击 <code>Navicat</code> 左侧的 <code>连接名称</code>，如果能够进行展开，并看到其内的 <code>test</code> 数据库和其它的系统自带的数据库，则说明连接成功。如下图：</p>
<p><img src="./imgs/connect-db/finish.png" alt="" /></p>
<p><strong>PS：图里面的 <code>seamart</code> 数据库是后续建立的，没有是正常情况。</strong></p>
<h2 id="常见-q--a"><a class="header" href="#常见-q--a">常见 Q &amp; A</a></h2>
<h3 id="因为数据库未打开连接失败"><a class="header" href="#因为数据库未打开连接失败">因为数据库未打开，连接失败</a></h3>
<p>在连接过程中，可能出现连接失败，这时候可能是因为数据库还未打开，如果出现这种情况，请先打开金仓数据库，再重新尝试连接。</p>
<p>解决方案如下：</p>
<ol>
<li>到金仓数据库的安装路径内，如：
<img src="./imgs/start_db/install_path.png" alt="" /></li>
<li>选择 <code>Server</code> 这个快捷方式，进入到 <code>Server</code> 的 <code>bin</code> 目录，如：
<img src="./imgs/start_db/server_bin.png" alt="" /></li>
<li>打开命令行(我使用的是 <code>Powershell</code>)并进入到 <code>bin</code> 目录，如：
<img src="./imgs/start_db/kb_psl.png" alt="" /></li>
<li>输入命令：<code>./system_ctl.exe -D 你的数据目录 start</code>，这里提到的 <code>你的数据目录</code>，就是在之前环境配置里配过的内容，如果用的是默认的，那就在你的安装目录里的 <code>data</code> 目录内。如图所示：
<img src="./imgs/start_db/cmd.png" alt="" /></li>
</ol>
<p>预期如下所示：</p>
<p><img src="./imgs/start_db/finish.png" alt="" /></p>
<p>然后，回到 Navicat，重新点击 <code>测试连接</code>，如果连接成功，则可以正常连接金仓数据库。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="数据加载"><a class="header" href="#数据加载">数据加载</a></h1>
<p>本部分将介绍如何将<strong>课程资料包</strong>内的数据加载到金仓数据库中。若无课程资料包，请自行获取。作者无权也不会提供课程资料包。</p>
<h2 id="本节目录-3"><a class="header" href="#本节目录-3">本节目录</a></h2>
<ul>
<li><a href="data-load.html#%E6%95%B0%E6%8D%AE%E5%8A%A0%E8%BD%BD">数据加载</a>
<ul>
<li><a href="data-load.html#%E6%9C%AC%E8%8A%82%E7%9B%AE%E5%BD%95">本节目录</a></li>
<li><a href="data-load.html#%E8%83%8C%E6%99%AF%E7%9F%A5%E8%AF%86%E7%AE%80%E4%BB%8B">背景知识简介</a>
<ul>
<li><a href="data-load.html#sql-%E8%84%9A%E6%9C%AC">SQL 脚本</a></li>
<li><a href="data-load.html#%E5%88%86%E6%9E%90%E5%9E%8B%E6%95%B0%E6%8D%AE%E5%BA%93-postgresql">分析型数据库 PostgreSQL</a></li>
<li><a href="data-load.html#%E6%95%B0%E6%8D%AE%E5%BA%93%E6%A8%A1%E5%9E%8B">数据库模型</a></li>
<li><a href="data-load.html#%E7%BB%9D%E5%AF%B9%E8%B7%AF%E5%BE%84-%E5%92%8C-%E7%9B%B8%E5%AF%B9%E8%B7%AF%E5%BE%84">绝对路径 和 相对路径</a></li>
</ul>
</li>
<li><a href="data-load.html#%E5%AE%9E%E9%99%85%E6%93%8D%E4%BD%9C">实际操作</a></li>
<li><a href="data-load.html#%E5%AE%8C%E6%88%90%E6%A0%87%E5%BF%97">完成标志</a></li>
<li><a href="data-load.html#%E5%BC%BA%E8%B0%83%E9%A1%B9">强调项</a></li>
</ul>
</li>
</ul>
<h2 id="背景知识简介"><a class="header" href="#背景知识简介">背景知识简介</a></h2>
<h3 id="sql-脚本"><a class="header" href="#sql-脚本">SQL 脚本</a></h3>
<p>在数据迁移的过程中，一种常见的解决方案是将数据从源数据库导出为 SQL 脚本，随后在目标数据库中执行该脚本以实现数据的迁移。</p>
<p>SQL 脚本实质上是一系列 SQL 语句的集合，这些语句负责创建表格、插入数据、更新记录、删除记录等操作。当执行 SQL 脚本时，数据库管理系统会按照脚本文件中的顺序逐条执行这些语句，从而完成数据的迁移工作。</p>
<h3 id="分析型数据库-postgresql"><a class="header" href="#分析型数据库-postgresql">分析型数据库 PostgreSQL</a></h3>
<p>数据库系统根据其设计目的和应用场景的不同，可以分为多种类型。例如，MySQL 数据库主要用于处理在线事务处理（OLTP）任务，而 PostgreSQL 则专为在线分析处理（OLAP）而设计，适用于数据分析场景。数据库还可以根据数据模型的不同，分为关系型和非关系型两大类。</p>
<p>PostgreSQL 是一款功能强大的开源分析型数据库，金仓数据库与其类似，同样属于分析型数据库。这类数据库的主要特点是更加侧重于数据分析。本课程资料包中的 Seamart 数据集即是源自金仓数据库，专为分析目的而设计的。</p>
<h3 id="数据库模型"><a class="header" href="#数据库模型">数据库模型</a></h3>
<p>数据库系统在架构上可以类比于一款 Web 应用。正如 Web 应用包含前端和后端，前端负责用户界面的展示和数据交互，后端则处理逻辑和存储数据。类似地，数据库系统也可以分为前端和后端。数据库的前端通常负责数据的展示和收集，而后端则由数据库管理员负责维护，确保数据的安全性和完整性。</p>
<h3 id="绝对路径-和-相对路径"><a class="header" href="#绝对路径-和-相对路径">绝对路径 和 相对路径</a></h3>
<p>绝对路径是指从根目录开始的完整路径。它不依赖于当前的工作目录，因此总是指向同一个位置，无论当前的工作目录在哪里。绝对路径通常以斜杠 / 开头。例如，要访问 <code>C:\user\documents\reports</code>，绝对路径就是 <code>C:\user\documents\reports</code>。</p>
<p>相对路径是指从当前工作目录开始的路径。它依赖于当前的工作位置，因此当工作目录改变时，相对路径也会随之改变。使用相对路径的好处是它更加灵活。例如，如果当前目录是 <code>C:\user\documents\</code>，而您想要访问 <code>C:\user\documents\reports</code>，相对路径可以简单地写作 <code>.\reports</code>。</p>
<p>至于说 windows 系统内如何查看文件的绝对路径，这个自行学习吧...</p>
<h2 id="实际操作"><a class="header" href="#实际操作">实际操作</a></h2>
<p>既然我们需要对数据库进行操作，那肯定是用管理员端最轻松了，所以首先进到管理员端，然后我们就可以开始操作了。</p>
<ol>
<li>到金仓数据库的安装路径内，如：
<img src="./imgs/start_db/install_path.png" alt="" /></li>
<li>选择 <code>Server</code> 这个快捷方式，进入到 <code>Server</code> 的 <code>bin</code> 目录，如：
<img src="./imgs/start_db/server_bin.png" alt="" /></li>
<li>打开命令行(我使用的是 <code>Powershell</code>)并进入到 <code>bin</code> 目录，如：
<img src="./imgs/start_db/kb_psl.png" alt="" /></li>
<li><code>bin</code> 目录内，我们需要增加数据，需要使用 <code>ksql.exe</code> 来执行 SQL 脚本，到官网可以查到它的用法，我们需要的内容如下：
<ul>
<li><code>-f</code>：指定要执行的 SQL 脚本文件。</li>
<li><code>-U</code>：指定以什么人登录。</li>
<li><code>-d</code>：指定要连接的数据库。
<blockquote>
<p>可以看到，我们在读入数据时，是需要先指定数据库的，但数据库哪来的呢？我们可以看到，课程资料包内的 <code>seamart数据集</code> 目录下有两个 SQL 脚本，分别是 <code>DDL.sql</code> 和 <code>seamart.sql</code>，我们需要先执行 <code>DDL.sql</code> 创建数据库，再执行 <code>seamart.sql</code> 为新建的数据库添加数据。</p>
</blockquote>
</li>
</ul>
</li>
<li>执行 <code>DDL.sql</code>，如：<code>./ksql.exe -Usystem -dtest -f DDL.sql的路径</code>。<code>DDL.sql</code> 的路径需要自行填写其<strong>绝对路径</strong>。</li>
<li>执行 <code>seamart.sql</code>，如：<code>./ksql.exe -Usystem -dseamart -f seamart.sql的路径</code>。<code>seamart.sql</code> 的路径需要自行填写其<strong>绝对路径</strong>。</li>
</ol>
<p>理论上来说，这样就可以把数据导入到数据库中了。</p>
<p><strong>PS：不是说相对路径不好使，只是说绝对路径方便且不易写错。</strong></p>
<h2 id="完成标志-3"><a class="header" href="#完成标志-3">完成标志</a></h2>
<p>使用 <code>Navicat</code> 连接 <code>kingbase</code>，能够在其内看到 <code>seamart</code> 数据库，打开后发现其中存在着 <code>sales</code> 表，如：</p>
<p><img src="./imgs/data_load/finish.png" alt="" /></p>
<h2 id="强调项-2"><a class="header" href="#强调项-2">强调项</a></h2>
<ul>
<li>
<p>请注意脚本执行顺序！</p>
</li>
<li>
<p>Navicat 在运行 SQL 脚本时，会按照顺序，<strong>交由实际的数据库</strong>执行 SQL 语句，所以，它的执行效果可以视作每一行都是在进行一次事务的 commit，所以，一旦运行过程中出现错误，那么，在错误发生之前的所有操作并不会被回滚。所以这时候，最好把出错的那个数据库<strong>删掉</strong>之后，再<strong>重新开始导入</strong>。不然会出现很多奇奇怪怪的问题。</p>
<blockquote>
<p>PS：删除数据库最简单的方法是在 <code>Navicat</code> 里直接右键点击该数据库然后选择<code>删除</code>，但需要注意一点，<code>Navicat</code> 在做这种基于数据库的操作时，完成后最好关掉这个连接，然后重新打开连接(没错，就是手动刷新！)，以防出现奇奇怪怪的问题。</p>
</blockquote>
</li>
<li>
<p>虽说我应该是踩过坑了，但我仍然不想复现那些奇奇怪怪的问题，故在此处就不写那部分的内容了。</p>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="数据迁移"><a class="header" href="#数据迁移">数据迁移</a></h1>
<p>本部分预计记录将金仓里的数据迁移至 MySQL 的流程。</p>
<h2 id="本节目录-4"><a class="header" href="#本节目录-4">本节目录</a></h2>
<ul>
<li><a href="data-migration.html#%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB">数据迁移</a>
<ul>
<li><a href="data-migration.html#%E6%9C%AC%E8%8A%82%E7%9B%AE%E5%BD%95">本节目录</a></li>
<li><a href="data-migration.html#%E5%A4%A7%E4%BD%93%E6%B5%81%E7%A8%8B%E4%BB%8B%E7%BB%8D">大体流程介绍</a></li>
<li><a href="data-migration.html#%E6%95%B0%E6%8D%AE%E5%AF%BC%E5%87%BA">数据导出</a>
<ul>
<li><a href="data-migration.html#%E8%83%8C%E6%99%AF">背景</a></li>
<li><a href="data-migration.html#navicat-%E5%AF%BC%E5%87%BA%E6%B5%81%E7%A8%8B">Navicat 导出流程</a></li>
</ul>
</li>
<li><a href="data-migration.html#%E9%80%82%E9%85%8D%E6%80%A7%E4%BF%AE%E6%94%B9">适配性修改</a>
<ul>
<li><a href="data-migration.html#1-%E4%BF%AE%E6%94%B9%E5%88%97%E5%90%8D%E5%92%8C%E8%A1%A8%E5%90%8D">1. 修改列名和表名</a></li>
<li><a href="data-migration.html#2-%E4%B8%BA-ddlsql-%E5%81%9A%E9%80%82%E9%85%8D">2. 为 DDL.sql 做适配</a></li>
<li><a href="data-migration.html#3-%E8%A7%A3%E5%86%B3-json-%E9%97%AE%E9%A2%98">3. 解决 json 问题</a></li>
<li><a href="data-migration.html#4-%E8%B0%83%E6%95%B4%E8%A7%86%E5%9B%BE">4. 调整视图</a></li>
</ul>
</li>
<li><a href="data-migration.html#%E6%95%B0%E6%8D%AE%E5%AF%BC%E5%85%A5">数据导入</a></li>
<li><a href="data-migration.html#%E9%AA%8C%E8%AF%81">验证</a></li>
<li><a href="data-migration.html#%E7%8E%B0%E5%AD%98%E9%97%AE%E9%A2%98">现存问题</a>
<ul>
<li><a href="data-migration.html#%E9%97%AE%E9%A2%98-i">问题 I</a></li>
<li><a href="data-migration.html#%E9%97%AE%E9%A2%98-i-%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88">问题 I 解决方案</a></li>
<li><a href="data-migration.html#%E9%97%AE%E9%A2%98-ii">问题 II</a></li>
<li><a href="data-migration.html#%E9%97%AE%E9%A2%98-ii-%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88">问题 II 解决方案</a></li>
<li><a href="data-migration.html#%E9%97%AE%E9%A2%98-iii">问题 III</a></li>
<li><a href="data-migration.html#%E9%97%AE%E9%A2%98-iii-%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88">问题 III 解决方案</a></li>
</ul>
</li>
<li><a href="data-migration.html#%E5%BC%BA%E8%B0%83%E9%A1%B9">强调项</a></li>
</ul>
</li>
</ul>
<h2 id="大体流程介绍"><a class="header" href="#大体流程介绍">大体流程介绍</a></h2>
<p>由于我们完成了将数据导入金仓数据库的部分，所以，下面的问题就演变成了，我们要把数据从金仓数据库迁移至 MySQL 数据库。</p>
<p>数据迁移的大体流程就是，先将数据导出成 sql 脚本，再使用目标数据库的 sql 引擎执行 sql 脚本，以此实现导入。</p>
<p>但由于数据库之间的差异，我们需要对 sql 脚本进行一些适配性修改，以使其能在 MySQL 中正常运行。</p>
<p>所以，虽然此节顺序是 <code>导出 -&gt; 修改 -&gt; 导入</code>，但实际我的操作过程中是 <code>导出 -&gt; 开始迭代 -&gt; 导入 -&gt; 报错后并修改 -&gt; 删掉数据库</code>。</p>
<h2 id="数据导出"><a class="header" href="#数据导出">数据导出</a></h2>
<h3 id="背景"><a class="header" href="#背景">背景</a></h3>
<p>金仓数据库提供了导出工具，但是，我们课程资料包里的数据是哪来的？估计就是用这个工具导出来的。而这个工具导出出来的 sql 脚本是不能被直接执行的，原因是导出的 sql 是基于金仓的 sql 引擎的，而我们的目标数据库是 MySQL，所以，我们需要对导出的 sql 脚本进行一些修改。</p>
<p>而由于数据量过大，如果直接对此脚本进行修改的话，工作量太大，所以选择通过数据库连接工具提供的导出方式进行导出。</p>
<h3 id="navicat-导出流程"><a class="header" href="#navicat-导出流程">Navicat 导出流程</a></h3>
<ol>
<li>右键要导出的数据库，选择 <code>导出向导</code>：
<ul>
<li><img src="./imgs/data_trans/export_guide.png" alt="" /></li>
</ul>
</li>
<li>选择导出类型为 <code>SQL 文件</code>，然后点击 <code>下一步</code>，之后我们点击左下角的 <code>全选</code>，然后再点击 <code>全选</code> 旁边的 <code>下拉按钮</code>，选择 <code>导出已选择的到相同文件</code>(<strong>图里面的是还没点击 <code>导出已选择的到相同文件</code> 的样子</strong>)：
<img src="./imgs/data_trans/select_all.png" alt="" /></li>
<li>然后继续点击下一步，最后点击<code>开始</code>:
<img src="./imgs/data_trans/start.png" alt="" /></li>
</ol>
<h2 id="适配性修改"><a class="header" href="#适配性修改">适配性修改</a></h2>
<p><strong>PS：这部分，如果有课程资料包，则不需要再做，这部分是记录了我的操作过程。</strong></p>
<h3 id="1-修改列名和表名"><a class="header" href="#1-修改列名和表名">1. 修改列名和表名</a></h3>
<p>我导出的 sql 脚本，起的名字是 <code>all.sql</code>，观察直接导出的内容，可以发现大体形如：</p>
<pre><code class="language-sql">INSERT INTO "adminaddrs" ("addrid", "stdcode", "addrname", "parentid", "currlevel") VALUES ("1", NULL, "阿富汗", 1, 0);
/* ... 其他的内容省略了 ... */
</code></pre>
<p>熟悉 mysql 的同学应该知道，mysql 的表名和列名在使用时是<strong>不能</strong>用双引号的，所以，我们需要将所有的双引号替换成 <code>反引号</code>(电脑键盘左上角的 Esc 下面) 。</p>
<p>在这一步，我是使用的 vscode 的替换来做的，这也为下面的一个问题的产生，带来了隐患。</p>
<h3 id="2-为-ddlsql-做适配"><a class="header" href="#2-为-ddlsql-做适配">2. 为 DDL.sql 做适配</a></h3>
<p>当直接执行我们修改完的数据脚本时，会报错，报错日志说 <code>找不到数据库</code>，那显而易见，我们还没有创建数据库，所以，我们需要先创建数据库，再执行脚本。那我们就需要先运行我们之前用的 <code>DDL.sql</code> 脚本。</p>
<p>当直接执行 DDL.sql 时，会报错，经过分析，因为金仓作为分析型数据库，其变量类型和 MySQL 的变量类型不同，所以需要做一大批的修改，如下所
示：</p>
<ul>
<li>@Diff:</li>
<li>
<ol>
<li>MySQL 的 <code>schema</code> 与 <code>database</code> 相同含意, 故删除了原先对 数据库 的定义，最后效果是保留了 <code>schema (sales)</code></li>
</ol>
</li>
<li>
<ol start="2">
<li>MySQL 不支持 <code>INTERVAL</code> 类型, 故将该字段改为 <code>CHAR(16)</code> 类型以适配 <code>ISO 8601</code> 格式</li>
</ol>
</li>
<li>
<ol start="3">
<li>MySQL 无 <code>NUMERIC</code> 类型, 故将此种类型改为 <code>DECIMAL</code> 类型</li>
</ol>
</li>
<li>
<ol start="4">
<li>MySQL 无 <code>MONEY</code> 类型, 原先尝试也改为 <code>DECIMAL</code> 类型, 但后来发现此项会产生类似 <code>$16.30</code>, 故改为 <code>VARCHAR(16)</code> 类型</li>
</ol>
</li>
<li>
<ol start="5">
<li>MySQL 的 <code>TIMESTAMP</code> 不对应于时区, 故将原始的 <code>TIMESTAMP WITH TIME ZONE</code> 类型改为 <code>TIMESTAMP</code> 类型</li>
</ol>
</li>
<li>
<ol start="6">
<li>MySQL 不支持 <code>[1199,2397)</code> 这种 <code>INT8RANGE</code> 类型, 故将 <code>INT8RANGE</code> 类型改为 <code>VARCHAR(16)</code> 类型</li>
</ol>
</li>
</ul>
<p>最后，修改完的此脚本，被命名为 <code>DDL_my.sql</code>，但也带来了一系列问题，后续会提到。</p>
<h3 id="3-解决-json-问题"><a class="header" href="#3-解决-json-问题">3. 解决 json 问题</a></h3>
<p>这个问题出现的根本原因是我不知道 mysql 还能插入 json 数据...</p>
<p>直接原因是：由于在 解决问题 1 时，我直接用的 vscode 的替换功能，导致 json 数据里的双引号也被替换了，所以，我们需要将 json 数据里的双引号替换回来。</p>
<p>在 vscode 里搜索 {` 这个符号，就能找到被异常替换掉的 json 数据，然后手动把反引号替换回双引号(英文版)即可。</p>
<h3 id="4-调整视图"><a class="header" href="#4-调整视图">4. 调整视图</a></h3>
<p>在 Navicat 导出的内容里，存在对金仓数据库里视图数据的导出，但是视图在 mysql 是不允许插入数据的，所以，我们需要删除这些视图的插入数据部分。</p>
<p>也就是说，我们需要移除最后的四个视图的插入数据，而是改成只视图定义部分。</p>
<p>但由于 MONEY 类型的问题，导致在 mysql 的视图定义部分涉及到的计算，我不会写了，所以这就导致视图是存在问题的。希望有大佬能够解决吧...</p>
<h2 id="数据导入"><a class="header" href="#数据导入">数据导入</a></h2>
<ol>
<li>Navicat 右键想要导入的<strong>连接</strong>，选择 <code>运行SQL文件</code>：</li>
<li>选择我们修改后的 <code>DDL_my.sql</code> 文件，然后点击 <code>开始</code>：
<img src="./imgs/data_trans/import_guide.png" alt="" /></li>
<li>然后再关掉连接，重新开启连接(刷新)，选择我们运行了 <code>DDL_my.sql</code> 后新建的数据库，再选择 <code>运行SQL文件</code>，选择我们修改后的 <code>all.sql</code> 文件，然后点击 <code>开始</code>，配置推荐，关闭 <code>错误后继续执行</code> 和 <code>一次运行多个</code>(毕竟是在调试嘛，如果用封装好的肯定就无所谓了)：
<img src="./imgs/data_trans/import_for_sales.png" alt="" /></li>
<li>等待运行完成，即可完毕。</li>
</ol>
<h2 id="验证"><a class="header" href="#验证">验证</a></h2>
<p>使用 Navicat 打开 mysql 数据库，核对数据数量、数据内容，发现相同，则认为数据迁移成功。</p>
<p>如下图：</p>
<p><img src="./imgs/data_trans/verify.png" alt="" /></p>
<p><strong>PS：虽然行数看起来对不上，但打开表格后，发现数据量是相同的(以 adminaddrs 为例，都是 664 页 277 行，每页 1000 行)，所以，可以认为数据迁移成功。</strong></p>
<h2 id="现存问题"><a class="header" href="#现存问题">现存问题</a></h2>
<h3 id="问题-i"><a class="header" href="#问题-i">问题 I</a></h3>
<p>视图(View) 因为 金仓 的特殊性 (金仓有 MONEY 类型, 该类型的数据示例："$1.00", 在 mysql 里, 我采用 "VARCHAR(16)" 来代替), 这使得如下列出的两张视图(建立这两张视图的 sql 脚本位于 all.sql 的末尾部分)：</p>
<ul>
<li>shop_orders</li>
<li>shopstat</li>
</ul>
<p>这两张视图的数据存在问题, 具体问题在于：</p>
<ul>
<li>shop_orders: 其最后一列(列名为 good_bal)存在问题, 直接原因是建立视图的时候, 对金额的计算公式写的不对, 根本原因如上所示。</li>
<li>shopstat: 其最后一列 totalprice 也涉及金融计算, 导致数据异常</li>
</ul>
<p>且发现：
shop_orders 里的数据也多两行
shopstat 里的数据多两行
但我看了其它的表格里的数据数量, 都是相同的... 这就有点疑惑...</p>
<p>金仓里的视图的数据被放置在了 <code>send/kingbase/</code> 内的 2 个 sql 文件里, 那 2 个 sql 中的内容即是金仓里的视图定义后, 显示出来的正确数据。</p>
<h3 id="问题-i-解决方案"><a class="header" href="#问题-i-解决方案">问题 I 解决方案</a></h3>
<p>通过调整 View 的定义(但是我不太会...), 修正金额计算的部分, 使视图正常发挥作用。</p>
<h3 id="问题-ii"><a class="header" href="#问题-ii">问题 II</a></h3>
<p>金仓数据库支持定义函数, 但 mysql 好像不支持, 我查看了金仓里的定义部分, 发现它对函数的定义是写给系统配置的, 这造成无法进行导出, 因为不知道：</p>
<ol>
<li>mysql 支不支持函数定义(AI 说好像没有用)？</li>
<li>相同的定义会不会因为配置项问题导致不兼容？</li>
<li>函数无法导出的情况下, 有没有必要进行额外设置？</li>
</ol>
<h3 id="问题-ii-解决方案"><a class="header" href="#问题-ii-解决方案">问题 II 解决方案</a></h3>
<p>主要还是不熟悉 mysql 的某些内容, 看老师需求来定吧</p>
<h3 id="问题-iii"><a class="header" href="#问题-iii">问题 III</a></h3>
<p>疑似因为 视图 的计算存在问题的原因, 导致了 ER 图 存在问题</p>
<h3 id="问题-iii-解决方案"><a class="header" href="#问题-iii-解决方案">问题 III 解决方案</a></h3>
<p>我在附上了金仓数据库里面的 ER 图</p>
<h2 id="强调项-3"><a class="header" href="#强调项-3">强调项</a></h2>
<blockquote>
<p>注意导入时，要<strong>先选择连接</strong>，再执行 <code>DDL_my.sql</code>，mysql 将对数据库的操作视为事务，并且 <code>拒绝在一个数据库中新建新的数据库</code> 这种类型的操作。</p>
</blockquote>
<blockquote>
<p>由于不是很会 MySQL，再加上懒且时间少，我没有做好对 视图 的适配，希望后续有大佬能够改好...</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="脱离-navicat-依赖"><a class="header" href="#脱离-navicat-依赖">脱离 Navicat 依赖</a></h1>
<p>在后续的操作过程中, 有同学提出了一个问题: <code>我用的是 MacOS, 而且没有 Navicat, 那我怎么使用课程资料包呢？</code></p>
<blockquote>
<p>这个问题之前我确实没有考虑过, 后来在东北大学软件学院刘莹老师的指导下, 想到了一种解决方案:</p>
<ol>
<li>在可以进行移植的计算机上, 进行数据移植</li>
<li>使用 mysql, 将移植后的数据, 再次导出</li>
<li>分享 sql 脚本</li>
</ol>
<p>理论来说, 这样就可以使数据脱离 Navicat 依赖了。</p>
</blockquote>
<p>但是在本节, 将给出<strong>并非</strong>参照上述解决方案进行解决的流程, 而是通过直接修改原始的 sql 脚本。如果需要复现, 自然可以, 当然也可以直接使用我制作的课程资料包的补丁包 <code>apple</code> 进行操作。</p>
<h2 id="本节目录-5"><a class="header" href="#本节目录-5">本节目录</a></h2>
<ul>
<li><a href="navicat-free.html#%E8%84%B1%E7%A6%BB-navicat-%E4%BE%9D%E8%B5%96">脱离 Navicat 依赖</a>
<ul>
<li><a href="navicat-free.html#%E6%9C%AC%E8%8A%82%E7%9B%AE%E5%BD%95">本节目录</a></li>
<li><a href="navicat-free.html#%E6%89%80%E9%9C%80%E7%8E%AF%E5%A2%83">所需环境</a></li>
<li><a href="navicat-free.html#%E9%97%AE%E9%A2%98%E6%8F%8F%E8%BF%B0">问题描述</a></li>
<li><a href="navicat-free.html#%E8%A7%A3%E5%86%B3%E6%B5%81%E7%A8%8B%E4%B8%8E%E5%9D%91">解决流程与坑</a>
<ul>
<li><a href="navicat-free.html#%E5%AD%97%E7%AC%A6%E9%9B%86%E6%9C%89%E9%97%AE%E9%A2%98-">字符集有问题! ?</a></li>
<li><a href="navicat-free.html#ddl-%E5%B0%B1%E4%B8%8D%E8%A1%8C">DDL 就不行</a></li>
<li><a href="navicat-free.html#%E9%80%82%E9%85%8D-ddl">适配 DDL</a></li>
<li><a href="navicat-free.html#%E9%80%82%E9%85%8D-allsql">适配 all.sql</a></li>
</ul>
</li>
<li><a href="navicat-free.html#%E4%BD%BF%E7%94%A8%E8%A1%A5%E4%B8%81%E5%8C%85">使用补丁包</a></li>
<li><a href="navicat-free.html#%E8%A1%A5%E4%B8%81%E8%AF%A6%E6%83%85">补丁详情</a>
<ul>
<li><a href="navicat-free.html#ddl_mysql">DDL_my.sql</a></li>
<li><a href="navicat-free.html#allsql">all.sql</a></li>
</ul>
</li>
<li><a href="navicat-free.html#%E5%90%8E%E7%BB%AD%E6%80%9D%E8%80%83">后续思考</a></li>
</ul>
</li>
</ul>
<h2 id="所需环境"><a class="header" href="#所需环境">所需环境</a></h2>
<p>若想要复刻我的操作, 请准备好如下环境:</p>
<ul>
<li>vscode (最新版即可, 下载链接: https://code.visualstudio.com/Download)</li>
<li>mysql (兼容 8.0.35 版本的皆可, 我用的是 8.0.35)</li>
</ul>
<h2 id="问题描述"><a class="header" href="#问题描述">问题描述</a></h2>
<p>在使用命令行操作 mysql 后, 用 source 命令导入资料包给的 sql 脚本, 发现大量报错, 原因经排查为"字符集"问题。</p>
<h2 id="解决流程与坑"><a class="header" href="#解决流程与坑">解决流程与坑</a></h2>
<h3 id="字符集有问题-"><a class="header" href="#字符集有问题-">字符集有问题! ?</a></h3>
<p>看日志说是字符集问题, 那么, 问题来了, 它字符集为什么有问题呢？？</p>
<p>使用 vscode 打开 all.sql 脚本, 发现其编码格式用的是 utf8。而且, 这个 utf8 是我特意改的。</p>
<p>回顾之前的操作, 原始的课程资料包里面的 kingbase 导出的内容编码是 gbk, 这导致了 mysql 导入时出错, 也使得 <code>基于 Navicat 执行 sql 脚本</code> 时出错。</p>
<p>为了处理这个问题, 最后我用 ksql 执行了操作后, 再用 Navicat 将数据从金仓数据库导出, 导出时, 选择导出为 utf8 编码的 sql 文件, 这样解决了数据迁移的问题。也是因为这个, 使得编码格式变为了 utf8。</p>
<p>既然问题的原因难以确定, 我们不妨尝试分析下到底是什么时候产生了问题...</p>
<h3 id="ddl-就不行"><a class="header" href="#ddl-就不行">DDL 就不行</a></h3>
<p>首先, 在自己的操作系统里安装且配置好 mysql 的环境后, 使用如下语句进行连接:</p>
<pre><code class="language-powershell">mysql -u root -p
# 然后, 先建立数据库的结构
# 注意下面命令, 要改成你的 DDL_my.sql 的路径
source DDL_my.sql的绝对路径
# 注意不要在结尾加 `;`
</code></pre>
<p>直接报错了！输出如下:</p>
<pre><code class="language-plaintext">Query OK, 1 row affected (0.01 sec)

Database changed
Query OK, 0 rows affected (0.04 sec)

Query OK, 0 rows affected (0.03 sec)

Query OK, 0 rows affected (0.02 sec)

Query OK, 0 rows affected (0.03 sec)

Query OK, 0 rows affected (0.02 sec)

ERROR 1271 (HY000): Illegal mix of collations for operation ' IN '
ERROR 1267 (HY000): Illegal mix of collations (utf8mb4_0900_ai_ci,IMPLICIT) and (gbk_chinese_ci,COERCIBLE) for operation '='
Query OK, 0 rows affected (0.04 sec)

Query OK, 0 rows affected (0.04 sec)
</code></pre>
<p>看其报错信息, 感觉是字符集的问题, 主要是产生了冲突, 位于 <code>IN</code> 和 <code>=</code> 这两个<strong>操作符</strong>上！</p>
<blockquote>
<p>话说这为啥啊？？？我不是统一过字符集嘛？？？</p>
</blockquote>
<h3 id="适配-ddl"><a class="header" href="#适配-ddl">适配 DDL</a></h3>
<p>没什么好办法, 先重新统一一下字符集试试...</p>
<ul>
<li>当统一字符集为 utf8mb4 后, 发现报错依旧存在...</li>
<li>当统一字符集为 gbk 后, 报错变成了 warning</li>
</ul>
<p>那就先这样吧！都用 gbk 吧！</p>
<p>这一步, 代码修改如下:</p>
<pre><code class="language-plaintext">/**@Diff:
 * 1. 创建数据库时, 追加 `CHARACTER SET GBK`
 * 2. 创建每一个表时, 都追加 ` DEFAULT CHARSET=GBK`
 */
</code></pre>
<p>具体内容可以看本节最后一部分的<a href="navicat-free.html#%E8%A1%A5%E4%B8%81%E8%AF%A6%E6%83%85">补丁详情</a>。</p>
<h3 id="适配-allsql"><a class="header" href="#适配-allsql">适配 all.sql</a></h3>
<p>在统一字符集为 gbk 后, 在 DDL_my.sql 运行完毕后, 再运行 all.sql, 发现报错依旧存在...</p>
<p>看报错, 内容出现了 "\x0" 这类的字符, 有充足的理由怀疑还是字符集的问题。</p>
<p>然后, 用 <code>vscode</code> 打开后, 将其编码格式修改为 <code>gbk</code>, 再次运行, 发现报错没了。</p>
<blockquote>
<p>PS: vscode 里修改编码的方法, 已放置到 <a href="./qa.html#%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8-vscode-%E8%B0%83%E6%95%B4%E6%96%87%E4%BB%B6%E7%BC%96%E7%A0%81">QA 文档</a>。</p>
</blockquote>
<h2 id="使用补丁包"><a class="header" href="#使用补丁包">使用补丁包</a></h2>
<p>本部分将会介绍, 拿到补丁包后, 如何使用。</p>
<blockquote>
<p>PS: 小常识, <code>补丁</code> 的英文是 <code>patch</code></p>
<p><code>patch</code> 文件一般通过 <code>diff</code> 工具生成, 我比较钟爱 <code>git diff</code></p>
<p>阅读 <code>patch</code> 文件时, 左侧的 <code>-</code> 代表被删去的行, 右侧的 <code>+</code> 代表新增的行。</p>
</blockquote>
<pre><code class="language-powershell">mysql -u root -p
# 然后, 先建立数据库的结构
# 注意下面命令, 要改成你的 DDL_my.sql 的路径 和 all.sql 路径
source DDL_my.sql的绝对路径
source all.sql的绝对路径
</code></pre>
<h2 id="补丁详情"><a class="header" href="#补丁详情">补丁详情</a></h2>
<h3 id="ddl_mysql"><a class="header" href="#ddl_mysql">DDL_my.sql</a></h3>
<p><code>DDL_my.sql</code> 变化情况如下:</p>
<pre><code class="language-diff">diff --git a/DDL_my.sql b/DDL_my.sql
index b3a89ca..3b1055f 100755
--- a/DDL_my.sql
+++ b/DDL_my.sql
@@ -12,7 +12,7 @@
  */

 -- 创建 sales 数据库（在MySQL中, schema与database是同义词）
-CREATE DATABASE IF NOT EXISTS sales;
+CREATE DATABASE IF NOT EXISTS sales CHARACTER SET GBK;

 -- 切换到 sales 数据库（在MySQL中, 使用USE来切换数据库）
 USE sales;
@@ -25,7 +25,7 @@ CREATE TABLE Adminaddrs( /*行政区划地址 administration address*/
     parentid INTEGER REFERENCES Adminaddrs(addrid), /*父地址编码*/
     /*location  GEOMETRY, */                        /*经度纬度合一起的 GIS数据, 可能需要PostGis扩展插件支持, 可以用来计算就近仓库发货  */
     currlevel INTEGER                               /*当前层级 current level*/
-);
+) DEFAULT CHARSET=GBK;

 -- 创建 Categories 表
 CREATE TABLE Categories(/*商品分类*/
@@ -34,7 +34,7 @@ CREATE TABLE Categories(/*商品分类*/
     catgname VARCHAR(128),                          /*分类名称*/
     parentid INTEGER REFERENCES Categories(catgid), /*父类编码*/
     currlevel INTEGER                               /*当前层级 current level*/
-);
+) DEFAULT CHARSET=GBK;

 -- 创建 Shopstores 表
 /* Example: https://mall.jd.com/shopLevel-952805.html */
@@ -46,7 +46,7 @@ CREATE TABLE Shopstores(/*店铺*/
     delygrading DECIMAL(5,2),          /*物流评分 delivery grading*/
     servgrading DECIMAL(5,2),          /*服务评分service grading*/
     comprgrading DECIMAL(5,2)          /*综合评分 comprehensive grading*/
-);
+) DEFAULT CHARSET=GBK;

 -- 创建 Goods 表
 CREATE TABLE Goods(/*商品*/
@@ -66,7 +66,7 @@ CREATE TABLE Goods(/*商品*/
     size POLYGON,                                   /* 商品尺寸, 长 宽 高 */
     /*image  BINARY, */                             /* 商品图片 */
     instmanual TEXT                                 /* 使用说明  instruction manual */
-);
+) DEFAULT CHARSET=GBK;

 -- 创建 Supply 表
 CREATE TABLE Supply(/*店铺商品 供应*/
@@ -79,7 +79,7 @@ CREATE TABLE Supply(/*店铺商品 供应*/
     url VARCHAR(512),                               /* 商品网址 */
     homepage LONGTEXT,                              /* 商品网页转换而来的XML数据, 方便搜索, 使用LONGTEXT代替XML, 因为MySQL 8.0不再支持XML类型 */
     PRIMARY KEY(shopid, goodid)
-);
+) DEFAULT CHARSET=GBK;

 /*CREATE TYPE GENDERENUM AS ENUM(1, 2, 9); */ /*性别, 国家编码 1 男,  2 女,  9 未知*/

@@ -96,7 +96,7 @@ CREATE TABLE Customers(/*顾客*/
     mi VARCHAR(16) NULL,               /*月收入（是一个范围值）, monthly income, 使用DECIMAL代替INT8RANGE, 因为MySQL不支持INT8RANGE类型*/
     ebg CHAR(4) CHECK (ebg IN ('小学', '初中', '高中', '中专', '大专', '本科', '硕士', '博士', '其他')), /*教育程度,  有国家编码, 为简便起见, 直接使用汉字*/
     prof CHAR(50)                      /*所在行业 profession, 有国家编码, 为简便起见, 直接使用行业名称*/
-);
+) DEFAULT CHARSET=GBK;

 -- 创建 Comments 表
 CREATE TABLE Comments(/*商品评论*/
@@ -110,7 +110,7 @@ CREATE TABLE Comments(/*商品评论*/
     CHECK ((feeling = '好评' AND stars &gt;= 4)
         OR (feeling = '中评' AND (stars = 3 OR stars = 2))
         OR (feeling = '差评' AND stars = 1))
-);
+) DEFAULT CHARSET=GBK;

 -- 创建 Orders 表
 CREATE TABLE Orders(/*订单*/
@@ -140,7 +140,7 @@ CREATE TABLE Orders(/*订单*/
     mot CHAR(4),                                        /*运输方式 Mode of Transportation, 航空, 铁路、公路、水路等, 运输方式和发货收货距离 决定 预计到达日期 */
     doe DATE,                                           /*预计到达日期 date of estimation*/
     doa DATE                                            /*送达日期 date of arrival */
-);
+) DEFAULT CHARSET=GBK;

 -- 创建 Lineitems 表
 CREATE TABLE Lineitems(/*订单明细*/
@@ -151,4 +151,4 @@ CREATE TABLE Lineitems(/*订单明细*/
     saleamt INTEGER,                                    /*销售数量*/
     PRIMARY KEY (ordid, shopid, goodid),
     FOREIGN KEY (shopid, goodid) REFERENCES Supply(shopid, goodid)
-);
+) DEFAULT CHARSET=GBK;
</code></pre>
<h3 id="allsql"><a class="header" href="#allsql">all.sql</a></h3>
<p>将编码格式由 <code>utf-8</code> 修改至 <code>gbk</code>。</p>
<h2 id="后续思考"><a class="header" href="#后续思考">后续思考</a></h2>
<p>既然 mysql 能够允许 gbk 编码存在, 那是不是说明, 金仓数据库的 sql 导出内容, 可以通过某些逻辑, 快速适配移植到 mysql？</p>
<p>由于个人精力有限, 这个就交给各位大佬研究吧。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="q--a"><a class="header" href="#q--a">Q &amp; A</a></h1>
<h2 id="本节目录-6"><a class="header" href="#本节目录-6">本节目录</a></h2>
<ul>
<li><a href="qa.html#q--a">Q &amp; A</a>
<ul>
<li><a href="qa.html#%E6%9C%AC%E8%8A%82%E7%9B%AE%E5%BD%95">本节目录</a></li>
<li><a href="qa.html#%E5%A6%82%E4%BD%95%E5%9C%A8-navicat-%E9%87%8C%E7%9C%8B-er-%E5%9B%BE">如何在 Navicat 里看 ER 图？</a></li>
<li><a href="qa.html#%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8-vscode-%E8%B0%83%E6%95%B4%E6%96%87%E4%BB%B6%E7%BC%96%E7%A0%81">如何使用 vscode 调整文件编码？</a></li>
</ul>
</li>
</ul>
<h2 id="如何在-navicat-里看-er-图"><a class="header" href="#如何在-navicat-里看-er-图">如何在 Navicat 里看 ER 图？</a></h2>
<blockquote>
<p>博客链接：
<a href="https://www.cnblogs.com/kirin1105916774/p/11179132.html">使用 Navicat 生成 ER 关系图并导出</a></p>
</blockquote>
<h2 id="如何使用-vscode-调整文件编码"><a class="header" href="#如何使用-vscode-调整文件编码">如何使用 vscode 调整文件编码？</a></h2>
<p>以将文档编码改为 UTF-8 为例：</p>
<ol>
<li>
<p>使用 vscode 打开文件</p>
</li>
<li>
<p>按下 <code>ctrl + shift + p</code> 打开命令面板
<img src="./imgs/vscode_change_format/csp.png" alt="" /></p>
</li>
<li>
<p>输入 <code>Change File Encoding</code> 选择 <code>Change File Encoding</code>
<img src="./imgs/vscode_change_format/change.png" alt="" /></p>
</li>
<li>
<p>选择 <code>Save with encoding</code>
<img src="./imgs/vscode_change_format/save_with.png" alt="" /></p>
</li>
<li>
<p>输入 <code>UTF-8</code> 选择 <code>Convert to UTF-8</code>
<img src="./imgs/vscode_change_format/change_encoding.png" alt="" /></p>
</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="附录-a对-dmp-文件的探索"><a class="header" href="#附录-a对-dmp-文件的探索">附录 A：对 .dmp 文件的探索</a></h1>
<p>可能有些同学发现，在课程资料包的 <code>Seamart数据集</code> 目录内，有一个名为 <code>seamart.dmp</code> 的文件。这个东西是什么呢？</p>
<h2 id="某些定义下的-dmp"><a class="header" href="#某些定义下的-dmp">某些定义下的 .dmp</a></h2>
<p>直接问 bing，得到很多解释，都说是 <code>.dmp 文件</code> 是 windows 系统下的转储文件，用于记录系统崩溃时的内存信息，便于系统管理员进行故障排查。</p>
<p>那问题来了，windows 系统下的转储文件，为什么放在了数据集内呢？</p>
<h2 id="根据程序名猜测"><a class="header" href="#根据程序名猜测">根据程序名猜测</a></h2>
<p>观察 <code>Server/bin</code> 目录下的内容，发现有一个可执行文件，叫做 <code>sys_dump.exe</code>，从名字上看，这个程序可能应该是用来生成 <code>.dmp</code> 文件的。</p>
<p>官网查这个程序，发现它是一个用来进行数据库备份的程序，那么可以猜测，<code>seamart.dmp</code> 文件就是 <code>sys_dump.exe</code> 程序生成的数据库备份文件。</p>
<h2 id="确认"><a class="header" href="#确认">确认</a></h2>
<p>在官网上了解到，<code>sys_restore.exe</code> 是金仓提供的用来恢复数据库的程序，那么就使用此程序，加载 <code>seamart.dmp</code> 文件，看看是否能够成功恢复数据库。</p>
<p>我用的命令：<code>.\sys_restore.exe -Usystem -dseamart seamart.dmp的路径</code>。</p>
<p>经过验证，确实能够恢复部分数据，但过程中会产生大量的报错...</p>
<h2 id="现存问题-1"><a class="header" href="#现存问题-1">现存问题</a></h2>
<p>恢复过程中会出现报错，不知道是不是导致了恢复失败。(应该算是失败了，毕竟虽然表和数据库的结构出来了，但数据是没有的)</p>
<h2 id="进一步猜测"><a class="header" href="#进一步猜测">进一步猜测</a></h2>
<p>这个是后续我的思考：</p>
<p>观察 <code>Server/bin</code> 的内容，发现有一个 <code>sys_dumpall.exe</code> 的东西，猜测这个程序应该也是用来生成 <code>.dmp</code> 文件的。那么这就让人意识到一个问题，<code>sys_dump.exe</code> 和 <code>sys_dumpall.exe</code> 生成的 <code>.dmp</code> 文件，可能是不一样的。</p>
<ol>
<li>观察不用 dmp 文件，而是直接用 <code>seamart.sql</code> 恢复的数据库，发现其结构和内置的 <code>test</code> 数据库和 <code>kingbase</code> 数据库的结构类似，所以有一个疑问：
<ul>
<li>是不是 <code>sys_dump.exe</code> 是用来备份 <code>结构+数据</code> 的，而 <code>sys_dumpall.exe</code> 是用来备份某些特定数据库的 <code>结构+数据+该数据库的系统配置</code> 的？</li>
</ul>
</li>
<li>如果说该问题成立，那么可能是 <code>在导出数据时</code>，使用的程序问题，导致的恢复过程中一大堆报错。这个问题可能不是我们得到资料包的人能够解决的</li>
<li>如果该问题不成立，那么可能还是 <code>在导入数据时</code>，使用的程序问题，导致的恢复过程中一大堆报错。那么就说明可能是我的操作方法不对，但是懒得验证了，毕竟验证一次挺麻烦的，需要 <code>删掉数据库 -&gt; 重新导入数据(5min以上) -&gt; 观察日志继续推测 -&gt; 迭代...</code>。一套流程下来估计得快 10min 了。</li>
</ol>
<p>而且，还不能排除以下情况的影响：</p>
<ul>
<li>数据库名字是否有影响？
<ul>
<li>凭我的验证体验来看，应该是没有影响的，因为报错都一样。</li>
</ul>
</li>
<li>数据库内的系统环境配置是否有影响？
<ul>
<li>这个我尝试照着一篇博客去做，但是失败了，好像还把数据库给干崩了，只能无奈重装... 博客链接找不到了，反正最下面是说让配置数据库的系统搜索路径，然后 <code>alter</code> 执行一下，但是我没有成功还把数据库干崩了(恢复到之前的环境死活回不去了...)。</li>
</ul>
</li>
<li>数据库是否恢复前需要先建好表格和视图？
<ul>
<li>我尝试过不恢复和恢复，应该都不太行，但 <code>控制变量法</code> 验证时，变量太多且可能存在未知变量，故难以确保我验证的准确性。</li>
</ul>
</li>
</ul>
<h2 id="解决方案"><a class="header" href="#解决方案">解决方案</a></h2>
<p>希望有其它大佬能够给出解决方案，或者给出一些猜测吧。</p>
<p>毕竟对金仓还是很不熟的，不敢妄下断言，只能说有所猜测吧。</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
